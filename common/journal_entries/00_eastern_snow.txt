je_seeking_glory_in_eastern_snow = {
	icon = "gfx/interface/icons/event_icons/bicorne_hat.dds"

	group = je_group_poland

	is_shown_in_lobby = {
		c:PLC = THIS
	}

	possible = {
		# Optional: you could require some tech or milestone
		#has_technology_researched = nationalism
	}

	complete = {
		OR = {
			c:W66 = { is_subject_of = ROOT }
			c:PLC = {
				country_or_subject_owns_entire_state_region = STATE_PSKOV
				country_or_subject_owns_entire_state_region = STATE_NOVGOROD
				country_or_subject_owns_entire_state_region = STATE_TVER
			}
		}
	}

	on_complete = {
		add_modifier = {
			name = arts_of_the_eastern_snow
			months = 121
		}
		set_variable = eastern_snow_complete
        trigger_event = {
            id = eastern_snow.2
            popup = yes
        }
	}

	weight = 10000
	should_be_pinned_by_default = yes
}

je_polish_regency = {
    icon = "gfx/interface/icons/law_icons/monarchy.dds"

    group = je_group_poland

    is_shown_in_lobby = {
        c:PLC = THIS
    }

    possible = {
        # Optional gating if desired
        #has_technology_researched = nationalism
    }

	fail = {
		OR = {
			NOT = { 
				has_law_or_variant = law_type:law_monarchy 
			}
			NOT = { 
				ruler = { is_character = var:aasa_character } 
			}
		}
	}

    timeout = 3799

    on_timeout = {
        # Automatically complete the JE when timeout is reached
        complete_journal_entry = yes
        # Optional: trigger the coronation event immediately
        trigger_event = {
            id = polish_regency.2
            popup = yes
        }
    }

    modifiers_while_active = {
        #modifier_regency_of_aasa
    }

    complete = {
        date >= 1847.1.1
    }

    on_complete = {
        #remove_modifier = modifier_regency_of_aasa
        trigger_event = {
            id = polish_regency.2
            popup = yes
        }
    }

    weight = 10000
    should_be_pinned_by_default = yes
}

je_gold_of_golden_horde = {
	icon = "gfx/interface/icons/event_icons/bicorne_hat.dds"

	group = je_group_poland

	is_shown_in_lobby = {
		c:PLC = THIS
	}

	possible = {
		# Optional: require tech or milestone
		#has_technology_researched = nationalism
	}

	complete = {
		OR = {
			c:X45 = { is_subject_of = ROOT }
			c:PLC = {
				country_or_subject_owns_entire_state_region = STATE_TOMSK
				country_or_subject_owns_entire_state_region = STATE_SURGUT
				country_or_subject_owns_entire_state_region = STATE_OB
				country_or_subject_owns_entire_state_region = STATE_UPPER_YENISEYSK
				country_or_subject_owns_entire_state_region = STATE_KRASNOYARSK
				country_or_subject_owns_entire_state_region = STATE_YAKUTSK
				country_or_subject_owns_entire_state_region = STATE_OKHOTSK
				country_or_subject_owns_entire_state_region = STATE_KOLYMA
				country_or_subject_owns_entire_state_region = STATE_CHUKOTKA
				country_or_subject_owns_entire_state_region = STATE_KAMCHATKA
			}
		}
	}

	on_complete = {
		add_modifier = {
			name = modifier_gold_golden_horde
			years = 10
		}
		set_variable = gold_golden_horde_complete
        trigger_event = {
            id = eastern_snow.3
            popup = yes
        }
	}

	# Dynamic tooltip showing the ruler’s name
custom_tooltip = {
    text = golden_horde_quest_tt
    variables = {
        ruler_name = ruler_scope.GetFirstName
        pronoun = ruler_scope.GetHerHis
    }
}

	weight = 10000
	should_be_pinned_by_default = yes
}

je_polish_southern_expedition = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_poland

	possible = {
		# Optional: require tech or milestone
		#has_technology_researched = nationalism
	}

	immediate = {
		ruler ?= {
			save_scope_as = ruler_scope
		}
	}

	complete = {
		OR = {

			# Direct ownership by PLC
			c:PLC = {
				country_or_subject_owns_entire_state_region = STATE_AZERBAIJAN
				country_or_subject_owns_entire_state_region = STATE_ELIZAVETPOL
				country_or_subject_owns_entire_state_region = STATE_TABRIZ
				country_or_subject_owns_entire_state_region = STATE_MAZANDARAN
				country_or_subject_owns_entire_state_region = STATE_TURKMENIA
				country_or_subject_owns_entire_state_region = STATE_URALSK
				country_or_subject_owns_entire_state_region = STATE_KHIVA
				country_or_subject_owns_entire_state_region = STATE_SYRDARYA
				country_or_subject_owns_entire_state_region = STATE_UZBEKIA
				country_or_subject_owns_entire_state_region = STATE_MERZ
			}
		}
	}

	on_complete = {
		add_modifier = {
			name = modifier_polish_southern_glory
			years = 10
		}
		set_variable = je_polish_southern_expedition_complete
	}

	weight = 10000
	should_be_pinned_by_default = yes
}

je_polish_northern_expedition = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_poland

	possible = {
		# Optional: require tech or milestone
		#has_technology_researched = nationalism
	}

	immediate = {
		ruler ?= {
			save_scope_as = ruler_scope
		}
	}

	complete = {
		OR = {

			# Direct ownership by PLC
			c:PLC = {
				country_or_subject_owns_entire_state_region = STATE_COURLAND
				country_or_subject_owns_entire_state_region = STATE_RIGA
				country_or_subject_owns_entire_state_region = STATE_TARTU
				country_or_subject_owns_entire_state_region = STATE_TALINN
			}
		}
	}

	on_complete = {
		add_modifier = {
			name = modifier_polish_northern_glory
			years = 10
		}
		set_variable = je_polish_northern_expedition_complete
	}

	weight = 10000
	should_be_pinned_by_default = yes
}

je_polish_western_expedition = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_poland

	possible = {
		# Optional: require tech or milestone
		#has_technology_researched = nationalism
	}

	immediate = {
		ruler ?= {
			save_scope_as = ruler_scope
		}
	}

	complete = {
		OR = {

			# Direct ownership by PLC
			c:PLC = {
				country_or_subject_owns_entire_state_region = STATE_LOWER_SILESIA
				country_or_subject_owns_entire_state_region = STATE_BRANDENBURG
				country_or_subject_owns_entire_state_region = STATE_MECKLENBURG
				country_or_subject_owns_entire_state_region = STATE_SCHLESWIG_HOLSTEIN
				country_or_subject_owns_entire_state_region = STATE_SAXONY
			}
		}
	}

	on_complete = {
		add_modifier = {
			name = modifier_polish_western_glory
			years = 10
		}
		set_variable = je_polish_western_expedition_complete
	}

	weight = 10000
	should_be_pinned_by_default = yes
}

je_polish_controversial_queen = {
    icon = "gfx/interface/icons/law_icons/monarchy.dds"
    group = je_group_poland

    is_shown_in_lobby = { c:PLC = THIS }
    is_shown_when_inactive = { c:PLC = THIS }

    timeout = 3650

    possible = {
        game_date >= 1853.4.29
        has_law_or_variant = law_type:law_monarchy
    }

    scripted_progress_bar = je_polish_controversial_queen_progress_bar

    # Buttons
    scripted_button = je_polish_grant_republican_concessions
    scripted_button = je_polish_grant_aristocrat_powers

    immediate = {
        trigger_event = { id = polish_queen_rise.1 popup = yes }
    }

    complete = {
		custom_tooltip = {
			scope:journal_entry = {
				"scripted_bar_progress(je_polish_controversial_queen_progress_bar)" >= 100
			}
			text = je_polish_controversial_queen_complete_custom
		}
    }

    fail = {
        NOT = { has_law_or_variant = law_type:law_monarchy }
    }

    on_complete = {
        set_variable = je_polish_controversial_queen_complete
        trigger_event = { id = polish_queen_rise.3 popup = yes }
        remove_modifier = republican_concessions_active
        remove_modifier = aristocrat_powers_active
    }

    on_fail = {
        remove_modifier = republican_concessions_active
        remove_modifier = aristocrat_powers_active
    }

    on_monthly_pulse = {
        effect = {
            # Clamp progress to min/max
            if = {
                limit = {
                    scope:journal_entry = { "scripted_bar_progress(je_polish_controversial_queen_progress_bar)" < 0 }
                }
                scope:journal_entry = { set_bar_progress = { name = je_polish_controversial_queen_progress_bar value = 0 } }
            }
            if = {
                limit = {
                    scope:journal_entry = { "scripted_bar_progress(je_polish_controversial_queen_progress_bar)" > 100 }
                }
                scope:journal_entry = { set_bar_progress = { name = je_polish_controversial_queen_progress_bar value = 100 } }
            }
        }
    }

    weight = 10000
    should_be_pinned_by_default = yes

    custom_tooltip = {
        text = je_polish_controversial_queen_tt
        variables = {
            ruler_name = ruler_scope.GetFirstName
            pronoun = ruler_scope.GetHerHis
        }
    }
}
