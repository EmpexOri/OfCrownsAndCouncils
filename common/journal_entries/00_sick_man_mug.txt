je_sick_man_mug_main = {
	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	group = je_group_tanzimat_mug

	is_shown_in_lobby = {
		c:MUG = THIS
    }

	complete = {
		scope:journal_entry = {
			is_goal_complete = yes
		}
	}

	on_complete = {
		remove_modifier = sick_man_of_asia
		trigger_event = {
			id = sick_man_mug.2
		}
	}

	timeout = 10950

	on_timeout = {
		remove_modifier = sick_man_of_asia
		add_modifier = {
			name = dead_man_of_asia
			days = very_long_modifier_time
			is_decaying = yes
		}
		trigger_event = {
			id = sick_man_mug.3
		}
		if = {
			limit = {
	       		is_in_power_bloc = yes
	        	is_power_bloc_leader = yes
			}
			custom_tooltip = sick_man_of_europe_lose_power_bloc
		}
		custom_tooltip = {
			text = je_sick_man_main_failure_movements_tt
			set_variable = {
				name = failed_tanzimat
				years = 20
			}
		}
	}

	current_value = {
		value = var:sick_man_mug_var
	}

	goal_add_value = {
		add = 4
	}

	progressbar = yes

	weight = 10000

	should_be_pinned_by_default = yes
}

je_sick_man_mug_slavery = {
	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	group = je_group_tanzimat_mug

	complete = {
		has_law_or_variant = law_type:law_slavery_banned
	}

	on_complete = {
		custom_tooltip = je_sick_man_mug_advance
		change_variable = {
			name = sick_man_mug_var
			add = 1
		}
		set_variable = completed_slavery_mug_je
	}

	invalid = {
		custom_tooltip = {
			text = finished_sick_man_mug_tt
			has_variable = sick_man_mug_complete
		}
	}

	transferable = no

	weight = 5000

	should_be_pinned_by_default = yes
}

je_sick_man_mug_serfdom = {
	icon = "gfx/interface/icons/event_icons/event_trade.dds"

	group = je_group_tanzimat_mug

	complete = {
		NOR = {
			has_law_or_variant = law_type:law_serfdom
			has_law_or_variant = law_type:law_traditionalism
		}
	}

	on_complete = {
		custom_tooltip = je_sick_man_advance
		change_variable = {
			name = sick_man_var
			add = 1
		}
		add_journal_entry = {
			type = je_sick_man_mug_slavery
			custom_tooltip = sickman_syria_egypt
		}
	}

	invalid = {
		custom_tooltip = {
			text = finished_sick_man_mug_tt
			has_variable = sick_man_mug_complete
		}
	}

	transferable = no

	weight = 5000

	should_be_pinned_by_default = yes
}

je_sick_man_mug_economy = {
	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	group = je_group_tanzimat_mug

	complete = {
		in_default = no
		any_scope_state = {
			is_incorporated = yes
			has_building = building_urban_center
			percent >= 0.5
		}
	}

	on_complete = {
		set_variable = completed_sick_man_mug_economy_je
		custom_tooltip = je_sick_man_mug_advance
		change_variable = {
			name = sick_man_mug_var
			add = 1
		}
	}

	invalid = {
		custom_tooltip = {
			text = finished_sick_man_mug_tt
			has_variable = sick_man_mug_complete
		}
	}

	transferable = no

	weight = 5000
	should_be_pinned_by_default = yes
}

# Literacy and Universities
je_sick_man_mug_education = {
	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	group = je_group_tanzimat_mug

	complete = {
		any_scope_building = {
			is_building_type = building_university
			occupancy > 0.9
			level >= 5
		}
		scope:journal_entry = {
			is_goal_complete = yes
		}
	}

	on_complete = {
		set_variable = completed_sick_man_mug_education_je
		custom_tooltip = je_sick_man_mug_advance
		change_variable = {
			name = sick_man_mug_var
			add = 1
		}
	}

	current_value = {
		value = root.literacy_rate
	}

	goal_add_value = {
		add = 0.2
	}

	invalid = {
		custom_tooltip = {
			text = finished_sick_man_mug_tt
			has_variable = sick_man_mug_complete
		}
	}

	transferable = no

	weight = 5000

	should_be_pinned_by_default = yes

	progressbar = yes
}

# Nationalism
je_sick_man_mug_separatism = {
	icon = "gfx/interface/icons/event_icons/event_fire.dds"

	group = je_group_tanzimat_mug

	complete = {
		scope:journal_entry = {
			is_goal_complete = yes
		}
		highest_secession_progress < 0.5
	}

	on_complete = {
		set_variable = completed_separatism_sick_man_mug_je
		custom_tooltip = je_sick_man_mug_advance
		change_variable = {
			name = sick_man_mug_var
			add = 1
		}
	}

	on_monthly_pulse = {
		effect = {
			if = {
				limit = {
					highest_secession_progress < 0.5
				}
				change_variable = {
					name = sick_man_mug_separatist_var
					add = 1
				}
			}
		}
		# random_events = {
		# 	100 = 0
		# 	10 = tanzimat_events.5 # Paranoia Event
		# }
	}

	fail = {
		highest_secession_progress > 0.5
	}

	on_fail = {
		set_variable = failed_sick_man_mug_separatism
	}

	current_value = {
		value = var:sick_man_mug_separatist_var
	}

	goal_add_value = {
		add = 180
	}

	invalid = {
		custom_tooltip = {
			text = finished_sick_man_mug_tt
			has_variable = sick_man_mug_complete
		}
	}

	transferable = no

	weight = 5000

	should_be_pinned_by_default = yes

	progressbar = yes
}

# Army Reform
je_sick_man_mug_army = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_tanzimat_mug

	complete = {
		army_size >= 200
		has_technology_researched = napoleonic_warfare
		any_scope_building = {
			filter = {
				is_building_type = building_barracks
			}
			NOR = {
				building_has_goods_shortage = yes
				has_active_production_method = pm_no_organization
			}
			percent = 1
		}
		NOT = {
			any_military_formation = {
				filter = {
					is_army = yes
				}
				any_combat_unit = {
					has_unit_type = unit_type:combat_unit_type_irregular_infantry
				}
				percent >= 0.25
			}
		}
	}

	on_complete = {
		set_variable = completed_sick_man_mug_army_je
		custom_tooltip = je_sick_man_mug_advance
		change_variable = {
			name = sick_man_mug_var
			add = 1
		}
	}

	invalid = {
		custom_tooltip = {
			text = finished_sick_man_mug_tt
			has_variable = sick_man_mug_complete
		}
	}

	transferable = no

	should_be_pinned_by_default = yes

	weight = 5000
}


# Bureaucractic Reform
je_sick_man_mug_bureaucracy = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	group = je_group_tanzimat_mug

	complete = {
		NOR = {
			has_law_or_variant = law_type:law_hereditary_bureaucrats
			has_law_or_variant = law_type:law_land_based_taxation
			has_law_or_variant = law_type:law_consumption_based_taxation
		}
		bureaucracy >= 0
		approaching_bureaucracy_shortage = no
	}

	on_complete = {
		set_variable = completed_sick_man_mug_bureaucracy_je
		custom_tooltip = je_sick_man_mug_advance
		change_variable = {
			name = sick_man_mug_var
			add = 1
		}
		remove_modifier = outmoded_bureaucracy
	}

	# on_monthly_pulse = {
	# 	random_events = {
	# 		100 = 0
	# 		10 = tanzimat_events.9 # Land registration resisted
	# 	}
	# }

	invalid = {
		custom_tooltip = {
			text = finished_sick_man_mug_tt
			has_variable = sick_man_mug_complete
		}
	}

	transferable = no

	weight = 5000

	should_be_pinned_by_default = yes
}

je_sick_man_mug_sovereignity = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_tanzimat_mug

	complete = {
		has_variable = sick_man_mug_complete
	}

	on_complete = {
		add_loyalists = {
			value = 0.2
		}
	}

	fail = {
		any_scope_state = {
			is_treaty_port = yes
			state_region = {
				any_scope_state = {
					owner = root
				}
			}
		}
	}

	on_fail = {
		set_variable = failed_sick_man_mug_sovereignity
		add_radicals = {
			0.1
		}
	}

	transferable = no

	weight = 5000

	should_be_pinned_by_default = yes
}

